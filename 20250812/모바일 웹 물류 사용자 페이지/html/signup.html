<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원가입 - YCS 물류 시스템</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="navigation.js"></script>
    <style>
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .animate-slide-up { animation: slideUp 0.6s ease-out; }
        .shadow-blue-lg { box-shadow: 0 10px 25px -3px rgba(59, 130, 246, 0.1), 0 4px 6px -2px rgba(59, 130, 246, 0.05); }
        .bg-gradient-primary { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex items-center justify-center p-4">
    <div class="w-full max-w-md animate-slide-up">
        <div class="bg-white shadow-blue-lg border border-blue-100 rounded-lg">
            <!-- Header -->
            <div class="text-center pb-8 pt-8 px-8">
                <div class="flex items-center justify-center mb-6 relative">
                    <button onclick="navigateToLogin()" class="absolute left-0 p-2 text-blue-600/60 hover:text-blue-700 hover:bg-blue-50 rounded-full transition-all opacity-60 hover:opacity-100" aria-label="로그인 페이지로 돌아가기">
                        <i data-lucide="arrow-left" class="h-5 w-5"></i>
                    </button>
                    
                    <div class="w-16 h-16 bg-gradient-primary rounded-full flex items-center justify-center">
                        <i data-lucide="user" class="h-8 w-8 text-white"></i>
                    </div>
                </div>
                <h1 class="text-2xl text-blue-900 mb-3 font-bold">회원가입</h1>
            </div>

            <!-- Content -->
            <div class="px-8 pb-8">
                <!-- User Type Selection -->
                <div class="space-y-4 mb-8">
                    <label class="text-blue-900 font-medium">회원 유형</label>
                    <div class="grid grid-cols-1 gap-3">
                        <button type="button" onclick="selectUserType('general')" id="generalTypeBtn" class="user-type-btn p-4 rounded-lg border-2 border-blue-500 bg-blue-50 text-blue-700 flex items-center gap-3 transition-all duration-300">
                            <i data-lucide="user" class="h-5 w-5"></i>
                            <div class="text-left">
                                <div class="font-medium">일반 회원</div>
                                <div class="text-xs opacity-75">개인 사용자</div>
                            </div>
                        </button>
                        
                        <button type="button" onclick="selectUserType('corporate')" id="corporateTypeBtn" class="user-type-btn p-4 rounded-lg border-2 border-gray-200/50 hover:border-blue-300 text-gray-600 opacity-70 hover:opacity-100 flex items-center gap-3 transition-all duration-300">
                            <i data-lucide="building" class="h-5 w-5"></i>
                            <div class="text-left">
                                <div class="font-medium">기업 회원</div>
                                <div class="text-xs opacity-75">기업 담당자</div>
                            </div>
                        </button>

                        <button type="button" onclick="selectUserType('partner')" id="partnerTypeBtn" class="user-type-btn p-4 rounded-lg border-2 border-gray-200/50 hover:border-blue-300 text-gray-600 opacity-70 hover:opacity-100 flex items-center gap-3 transition-all duration-300">
                            <i data-lucide="users" class="h-5 w-5"></i>
                            <div class="text-left">
                                <div class="font-medium">파트너 회원</div>
                                <div class="text-xs opacity-75">제휴마케팅 파트너</div>
                            </div>
                        </button>
                    </div>
                </div>

                <form id="signupForm" class="space-y-6">
                    <!-- Common Fields -->
                    <div class="space-y-6">
                        <!-- Username -->
                        <div class="space-y-3">
                            <label for="username" class="text-blue-900 font-medium">아이디</label>
                            <div class="flex gap-3">
                                <input id="username" type="text" placeholder="아이디를 입력하세요 (4자 이상)" class="flex-1 h-14 px-4 border border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 bg-blue-50/30 hover:bg-blue-50/50 focus:bg-white transition-all duration-300 rounded-md outline-none">
                                <button type="button" onclick="checkUsernameAvailability()" id="usernameCheckBtn" class="h-14 px-6 border border-blue-200/50 text-blue-600/70 hover:bg-blue-50 hover:text-blue-700 hover:border-blue-300 opacity-70 hover:opacity-100 transition-all duration-300 rounded-md">
                                    중복확인
                                </button>
                            </div>
                            <div id="usernameValidation" class="hidden"></div>
                        </div>

                        <!-- Email -->
                        <div class="space-y-3">
                            <label for="email" class="text-blue-900 font-medium">이메일</label>
                            <div class="flex gap-3">
                                <input id="email" type="email" placeholder="이메일을 입력해주세요" class="flex-1 h-14 px-4 border border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 bg-blue-50/30 hover:bg-blue-50/50 focus:bg-white transition-all duration-300 rounded-md outline-none">
                                <button type="button" onclick="sendEmailVerification()" id="emailVerifyBtn" class="h-14 px-6 border border-blue-200/50 text-blue-600/70 hover:bg-blue-50 hover:text-blue-700 hover:border-blue-300 opacity-70 hover:opacity-100 transition-all duration-300 rounded-md">
                                    인증발송
                                </button>
                            </div>
                            
                            <!-- Email verification code input -->
                            <div id="emailCodeSection" class="hidden flex gap-3">
                                <input id="emailVerificationCode" type="text" placeholder="인증번호 6자리" maxlength="6" class="flex-1 h-14 px-4 border border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 bg-blue-50/30 hover:bg-blue-50/50 focus:bg-white transition-all duration-300 rounded-md outline-none">
                                <button type="button" onclick="verifyEmailCode()" id="emailCodeVerifyBtn" class="h-14 px-6 border border-blue-200/50 text-blue-600/70 hover:bg-blue-50 hover:text-blue-700 hover:border-blue-300 opacity-70 hover:opacity-100 transition-all duration-300 rounded-md">
                                    확인
                                </button>
                            </div>
                            
                            <div id="emailValidation" class="hidden"></div>
                        </div>

                        <!-- Password -->
                        <div class="space-y-3">
                            <label for="password" class="text-blue-900 font-medium">비밀번호</label>
                            <div class="relative">
                                <input id="password" type="password" placeholder="비밀번호를 입력하세요" class="w-full h-14 px-4 pr-12 border border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 bg-blue-50/30 hover:bg-blue-50/50 focus:bg-white transition-all duration-300 rounded-md outline-none">
                                <button type="button" onclick="togglePassword('password')" class="absolute right-4 top-1/2 transform -translate-y-1/2 text-blue-600/60 hover:text-blue-700 transition-colors opacity-70 hover:opacity-100 focus:opacity-100">
                                    <i data-lucide="eye" class="h-5 w-5" id="passwordEyeIcon"></i>
                                </button>
                            </div>
                            
                            <!-- Password validation indicator -->
                            <div id="passwordValidation" class="hidden p-3 bg-gray-50/50 rounded-lg border border-gray-200/50">
                                <p class="text-xs text-gray-600 mb-2">비밀번호 조건</p>
                                <div class="space-y-1">
                                    <div class="flex items-center gap-2 text-xs" id="minLengthCheck">
                                        <i data-lucide="alert-circle" class="h-3 w-3 text-gray-400"></i>
                                        <span class="text-gray-500">8자 이상</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-xs" id="letterCheck">
                                        <i data-lucide="alert-circle" class="h-3 w-3 text-gray-400"></i>
                                        <span class="text-gray-500">영문 포함</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-xs" id="numberCheck">
                                        <i data-lucide="alert-circle" class="h-3 w-3 text-gray-400"></i>
                                        <span class="text-gray-500">숫자 포함</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Confirm Password -->
                        <div class="space-y-3">
                            <label for="confirmPassword" class="text-blue-900 font-medium">비밀번호 확인</label>
                            <div class="relative">
                                <input id="confirmPassword" type="password" placeholder="비밀번호를 다시 입력하세요" class="w-full h-14 px-4 pr-12 border border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 bg-blue-50/30 hover:bg-blue-50/50 focus:bg-white transition-all duration-300 rounded-md outline-none">
                                <button type="button" onclick="togglePassword('confirmPassword')" class="absolute right-4 top-1/2 transform -translate-y-1/2 text-blue-600/60 hover:text-blue-700 transition-colors opacity-70 hover:opacity-100 focus:opacity-100">
                                    <i data-lucide="eye" class="h-5 w-5" id="confirmPasswordEyeIcon"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Individual User Fields -->
                    <div id="individualFields" class="space-y-6 pt-6 border-t border-blue-100">
                        <h3 class="font-medium text-blue-900">개인 정보</h3>
                        
                        <div class="space-y-3">
                            <label for="name" class="text-blue-900 font-medium">이름</label>
                            <input id="name" type="text" placeholder="이름을 입력하세요" class="w-full h-14 px-4 border border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 bg-blue-50/30 hover:bg-blue-50/50 focus:bg-white transition-all duration-300 rounded-md outline-none">
                        </div>

                        <div class="space-y-3">
                            <label for="phone" class="text-blue-900 font-medium">연락처</label>
                            <input id="phone" type="tel" placeholder="연락처를 입력해주세요" class="w-full h-14 px-4 border border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 bg-blue-50/30 hover:bg-blue-50/50 focus:bg-white transition-all duration-300 rounded-md outline-none">
                        </div>
                    </div>

                    <!-- Corporate/Partner User Fields -->
                    <div id="businessFields" class="hidden space-y-6 pt-6 border-t border-blue-100">
                        <h3 id="businessFieldsTitle" class="font-medium text-blue-900">회사 정보</h3>
                        
                        <div class="space-y-3">
                            <label for="companyName" class="text-blue-900 font-medium">회사명</label>
                            <input id="companyName" type="text" placeholder="회사명을 입력하세요" class="w-full h-14 px-4 border border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 bg-blue-50/30 hover:bg-blue-50/50 focus:bg-white transition-all duration-300 rounded-md outline-none">
                        </div>

                        <div class="space-y-3">
                            <label for="businessNumber" class="text-blue-900 font-medium">사업자등록번호</label>
                            <input id="businessNumber" type="text" placeholder="123-45-67890" class="w-full h-14 px-4 border border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 bg-blue-50/30 hover:bg-blue-50/50 focus:bg-white transition-all duration-300 rounded-md outline-none">
                        </div>

                        <div class="space-y-3">
                            <label for="businessCertificate" class="text-blue-900 font-medium">
                                사업자등록증 <span class="text-red-500">*</span>
                            </label>
                            <div class="space-y-3">
                                <div class="relative">
                                    <input id="businessCertificate" type="file" accept=".pdf,.jpg,.jpeg,.png" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10">
                                    <div class="h-14 px-4 border-2 border-dashed border-blue-200 hover:border-blue-300 bg-blue-50/30 hover:bg-blue-50/50 transition-all duration-300 rounded-md flex items-center gap-3 cursor-pointer">
                                        <i data-lucide="upload" class="h-5 w-5 text-blue-600"></i>
                                        <span class="text-blue-700" id="businessCertificateText">파일을 선택하세요</span>
                                    </div>
                                </div>
                                
                                <div class="text-xs text-gray-500 space-y-1">
                                    <p>• 파일 형식: PDF, JPG, PNG</p>
                                    <p>• 최대 파일 크기: 5MB</p>
                                </div>
                            </div>
                        </div>

                        <div class="space-y-3">
                            <label for="contactPerson" class="text-blue-900 font-medium">담당자 이름</label>
                            <input id="contactPerson" type="text" placeholder="담당자 이름을 입력하세요" class="w-full h-14 px-4 border border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 bg-blue-50/30 hover:bg-blue-50/50 focus:bg-white transition-all duration-300 rounded-md outline-none">
                        </div>

                        <div class="space-y-3">
                            <label for="contactPhone" class="text-blue-900 font-medium">담당자 연락처</label>
                            <input id="contactPhone" type="tel" placeholder="담당자 연락처를 입력하세요" class="w-full h-14 px-4 border border-blue-200 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 bg-blue-50/30 hover:bg-blue-50/50 focus:bg-white transition-all duration-300 rounded-md outline-none">
                        </div>
                    </div>

                    <!-- Terms Agreement -->
                    <div class="space-y-4 pt-6 border-t border-blue-100">
                        <label class="text-blue-900 font-medium">약관 동의</label>
                        <div class="space-y-3">
                            <div class="flex items-center space-x-3">
                                <input type="checkbox" id="agreeTerms" class="w-4 h-4 text-blue-600 border-blue-200 rounded focus:ring-blue-200">
                                <label for="agreeTerms" class="text-sm text-blue-700 cursor-pointer flex-1">
                                    이용약관에 동의합니다 <span class="text-red-500">*</span>
                                </label>
                                <button type="button" class="text-xs text-blue-600 hover:text-blue-700 underline">
                                    보기
                                </button>
                            </div>
                            
                            <div class="flex items-center space-x-3">
                                <input type="checkbox" id="agreePrivacy" class="w-4 h-4 text-blue-600 border-blue-200 rounded focus:ring-blue-200">
                                <label for="agreePrivacy" class="text-sm text-blue-700 cursor-pointer flex-1">
                                    개인정보 처리방침에 동의합니다 <span class="text-red-500">*</span>
                                </label>
                                <button type="button" class="text-xs text-blue-600 hover:text-blue-700 underline">
                                    보기
                                </button>
                            </div>
                            
                            <div class="flex items-center space-x-3">
                                <input type="checkbox" id="agreeMarketing" class="w-4 h-4 text-blue-600 border-blue-200 rounded focus:ring-blue-200">
                                <label for="agreeMarketing" class="text-sm text-blue-700 cursor-pointer flex-1">
                                    마케팅 정보 수신에 동의합니다 (선택)
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Error Message -->
                    <div id="errorMessage" class="hidden border border-red-200 bg-red-50/50 p-4 rounded-lg">
                        <div class="flex items-center gap-2">
                            <i data-lucide="alert-triangle" class="h-4 w-4 text-red-600"></i>
                            <p class="text-red-700" id="errorText"></p>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <button type="submit" id="submitBtn" class="w-full h-14 bg-gradient-primary hover:opacity-90 text-white font-medium rounded-lg shadow-blue-lg hover:shadow-blue-lg transition-all duration-300 transform hover:scale-[1.02] active:scale-[0.98] opacity-90 hover:opacity-100">
                        <span id="submitBtnText">회원가입</span>
                    </button>

                    <!-- Login Link -->
                    <div class="text-center pt-4">
                        <p class="text-sm text-blue-600/70">
                            이미 계정이 있으신가요?
                            <button type="button" onclick="navigateToLogin()" class="text-blue-600 hover:text-blue-700 font-medium underline opacity-70 hover:opacity-100 transition-all">
                                로그인하기
                            </button>
                        </p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let currentUserType = 'general';
        let isLoading = false;
        let validationState = {
            usernameChecked: false,
            usernameAvailable: false,
            emailVerified: false,
            emailCodeSent: false
        };
        let passwordValidation = {
            minLength: false,
            hasLetter: false,
            hasNumber: false
        };

        // Navigation functions
        function navigateToLogin() {
            window.location.href = 'login.html';
        }

        // User type selection
        function selectUserType(type) {
            currentUserType = type;
            
            // Update UI
            document.querySelectorAll('.user-type-btn').forEach(btn => {
                btn.className = 'user-type-btn p-4 rounded-lg border-2 border-gray-200/50 hover:border-blue-300 text-gray-600 opacity-70 hover:opacity-100 flex items-center gap-3 transition-all duration-300';
            });
            
            document.getElementById(type + 'TypeBtn').className = 'user-type-btn p-4 rounded-lg border-2 border-blue-500 bg-blue-50 text-blue-700 flex items-center gap-3 transition-all duration-300';
            
            // Show/hide appropriate fields
            if (type === 'general') {
                document.getElementById('individualFields').classList.remove('hidden');
                document.getElementById('businessFields').classList.add('hidden');
            } else {
                document.getElementById('individualFields').classList.add('hidden');
                document.getElementById('businessFields').classList.remove('hidden');
                document.getElementById('businessFieldsTitle').textContent = type === 'corporate' ? '회사 정보' : '파트너 정보';
            }
        }

        // Password toggle
        function togglePassword(fieldId) {
            const field = document.getElementById(fieldId);
            const icon = document.getElementById(fieldId + 'EyeIcon');
            
            if (field.type === 'password') {
                field.type = 'text';
                icon.setAttribute('data-lucide', 'eye-off');
            } else {
                field.type = 'password';
                icon.setAttribute('data-lucide', 'eye');
            }
            
            lucide.createIcons();
        }

        // Password validation
        function validatePassword(password) {
            const validation = {
                minLength: password.length >= 8,
                hasLetter: /[a-zA-Z]/.test(password),
                hasNumber: /[0-9]/.test(password)
            };
            
            passwordValidation = validation;
            updatePasswordValidationUI();
            
            return validation.minLength && validation.hasLetter && validation.hasNumber;
        }

        function updatePasswordValidationUI() {
            const checks = ['minLength', 'letter', 'number'];
            const validations = [passwordValidation.minLength, passwordValidation.hasLetter, passwordValidation.hasNumber];
            
            checks.forEach((check, index) => {
                const element = document.getElementById(check + 'Check');
                const icon = element.querySelector('i');
                const text = element.querySelector('span');
                
                if (validations[index]) {
                    icon.setAttribute('data-lucide', 'check-circle');
                    icon.className = 'h-3 w-3 text-green-500';
                    text.className = 'text-green-600';
                } else {
                    icon.setAttribute('data-lucide', 'alert-circle');
                    icon.className = 'h-3 w-3 text-gray-400';
                    text.className = 'text-gray-500';
                }
            });
            
            lucide.createIcons();
        }

        // Username availability check
        async function checkUsernameAvailability() {
            const username = document.getElementById('username').value.trim();
            
            if (!username) {
                showError('아이디를 입력해주세요.');
                return;
            }

            if (username.length < 4) {
                showError('아이디는 4자 이상이어야 합니다.');
                return;
            }

            setLoading(true);
            hideError();

            // Simulate API call
            setTimeout(() => {
                const unavailableUsernames = ['admin', 'test', 'user123', 'demo'];
                const isAvailable = !unavailableUsernames.includes(username.toLowerCase());
                
                validationState.usernameChecked = true;
                validationState.usernameAvailable = isAvailable;
                
                const validationDiv = document.getElementById('usernameValidation');
                validationDiv.classList.remove('hidden');
                
                if (isAvailable) {
                    validationDiv.innerHTML = `
                        <div class="flex items-center gap-2 text-sm text-green-600">
                            <i data-lucide="check-circle" class="h-4 w-4"></i>
                            사용 가능한 아이디입니다.
                        </div>
                    `;
                } else {
                    validationDiv.innerHTML = `
                        <div class="flex items-center gap-2 text-sm text-red-600">
                            <i data-lucide="alert-circle" class="h-4 w-4"></i>
                            이미 사용 중인 아이디입니다.
                        </div>
                    `;
                    showError('이미 사용 중인 아이디입니다.');
                }
                
                lucide.createIcons();
                setLoading(false);
            }, 1000);
        }

        // Email verification
        async function sendEmailVerification() {
            const email = document.getElementById('email').value.trim();
            
            if (!email) {
                showError('이메일을 입력해주세요.');
                return;
            }

            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showError('올바른 이메일 형식을 입력해주세요.');
                return;
            }

            setLoading(true);
            hideError();

            // Simulate API call
            setTimeout(() => {
                validationState.emailCodeSent = true;
                document.getElementById('emailCodeSection').classList.remove('hidden');
                document.getElementById('emailVerifyBtn').textContent = '재발송';
                setLoading(false);
                alert('인증번호가 이메일로 전송되었습니다. (데모: 123456)');
            }, 1000);
        }

        async function verifyEmailCode() {
            const code = document.getElementById('emailVerificationCode').value.trim();
            
            if (!code) {
                showError('인증번호를 입력해주세요.');
                return;
            }

            setLoading(true);
            hideError();

            // Simulate API call
            setTimeout(() => {
                if (code === '123456') {
                    validationState.emailVerified = true;
                    const validationDiv = document.getElementById('emailValidation');
                    validationDiv.classList.remove('hidden');
                    validationDiv.innerHTML = `
                        <div class="flex items-center gap-2 text-sm text-green-600">
                            <i data-lucide="check-circle" class="h-4 w-4"></i>
                            이메일 인증이 완료되었습니다.
                        </div>
                    `;
                    lucide.createIcons();
                    alert('이메일 인증이 완료되었습니다.');
                } else {
                    showError('인증번호가 일치하지 않습니다.');
                }
                setLoading(false);
            }, 1000);
        }

        // File upload handling
        function handleFileUpload(e) {
            const file = e.target.files?.[0];
            if (file) {
                // File size limit (5MB)
                if (file.size > 5 * 1024 * 1024) {
                    showError('파일 크기는 5MB 이하로 업로드해주세요.');
                    return;
                }

                // File type limit
                const allowedTypes = ['application/pdf', 'image/jpeg', 'image/png', 'image/jpg'];
                if (!allowedTypes.includes(file.type)) {
                    showError('PDF, JPG, PNG 파일만 업로드 가능합니다.');
                    return;
                }

                document.getElementById('businessCertificateText').textContent = file.name;
                hideError();
            }
        }

        // Error handling
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            const errorText = document.getElementById('errorText');
            errorText.textContent = message;
            errorDiv.classList.remove('hidden');
            lucide.createIcons();
        }

        function hideError() {
            document.getElementById('errorMessage').classList.add('hidden');
        }

        // Loading state
        function setLoading(loading) {
            isLoading = loading;
            const submitBtn = document.getElementById('submitBtn');
            const submitBtnText = document.getElementById('submitBtnText');
            
            if (loading) {
                submitBtnText.innerHTML = `
                    <div class="flex items-center gap-3">
                        <div class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                        처리 중...
                    </div>
                `;
                submitBtn.disabled = true;
            } else {
                submitBtnText.textContent = '회원가입';
                submitBtn.disabled = false;
            }
        }

        // Form validation and submission
        function validateForm() {
            // Username validation
            const username = document.getElementById('username').value.trim();
            if (!username) {
                showError('아이디를 입력해주세요.');
                document.getElementById('username').focus();
                return false;
            }

            if (!validationState.usernameChecked) {
                showError('아이디 중복체크를 해주세요.');
                document.getElementById('username').focus();
                return false;
            }

            if (!validationState.usernameAvailable) {
                showError('사용 가능한 아이디로 변경해주세요.');
                document.getElementById('username').focus();
                return false;
            }

            // Email validation
            const email = document.getElementById('email').value.trim();
            if (!email) {
                showError('이메일을 입력해주세요.');
                document.getElementById('email').focus();
                return false;
            }

            if (!validationState.emailVerified) {
                showError('이메일 인증을 완료해주세요.');
                document.getElementById('email').focus();
                return false;
            }

            // Password validation
            const password = document.getElementById('password').value;
            if (!password) {
                showError('비밀번호를 입력해주세요.');
                document.getElementById('password').focus();
                return false;
            }

            if (!validatePassword(password)) {
                showError('비밀번호는 8자 이상, 영문과 숫자를 포함해야 합니다.');
                document.getElementById('password').focus();
                return false;
            }

            const confirmPassword = document.getElementById('confirmPassword').value;
            if (password !== confirmPassword) {
                showError('비밀번호가 일치하지 않습니다.');
                document.getElementById('confirmPassword').focus();
                return false;
            }

            // User type specific validation
            if (currentUserType === 'general') {
                const name = document.getElementById('name').value.trim();
                if (!name) {
                    showError('이름을 입력해주세요.');
                    document.getElementById('name').focus();
                    return false;
                }

                const phone = document.getElementById('phone').value.trim();
                if (!phone) {
                    showError('연락처를 입력해주세요.');
                    document.getElementById('phone').focus();
                    return false;
                }
            } else {
                const companyName = document.getElementById('companyName').value.trim();
                if (!companyName) {
                    showError('회사명을 입력해주세요.');
                    document.getElementById('companyName').focus();
                    return false;
                }

                const businessNumber = document.getElementById('businessNumber').value.trim();
                if (!businessNumber) {
                    showError('사업자등록번호를 입력해주세요.');
                    document.getElementById('businessNumber').focus();
                    return false;
                }

                const businessCertificate = document.getElementById('businessCertificate').files[0];
                if (!businessCertificate) {
                    showError('사업자등록증을 첨부해주세요.');
                    document.getElementById('businessCertificate').focus();
                    return false;
                }

                const contactPerson = document.getElementById('contactPerson').value.trim();
                if (!contactPerson) {
                    showError('담당자 이름을 입력해주세요.');
                    document.getElementById('contactPerson').focus();
                    return false;
                }

                const contactPhone = document.getElementById('contactPhone').value.trim();
                if (!contactPhone) {
                    showError('담당자 연락처를 입력해주세요.');
                    document.getElementById('contactPhone').focus();
                    return false;
                }
            }

            // Terms validation
            const agreeTerms = document.getElementById('agreeTerms').checked;
            const agreePrivacy = document.getElementById('agreePrivacy').checked;
            
            if (!agreeTerms || !agreePrivacy) {
                showError('필수 약관에 동의해주세요.');
                return false;
            }

            return true;
        }

        // Form submission
        async function handleSubmit(e) {
            e.preventDefault();
            hideError();

            if (!validateForm()) {
                return;
            }

            setLoading(true);

            // Simulate API call
            setTimeout(() => {
                // Navigate to signup complete page
                window.location.href = `signup-complete.html?userType=${currentUserType}`;
                setLoading(false);
            }, 2000);
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize icons
            lucide.createIcons();
            
            // Form submission
            document.getElementById('signupForm').addEventListener('submit', handleSubmit);
            
            // Password validation on input
            document.getElementById('password').addEventListener('input', function(e) {
                const password = e.target.value;
                if (password) {
                    document.getElementById('passwordValidation').classList.remove('hidden');
                    validatePassword(password);
                } else {
                    document.getElementById('passwordValidation').classList.add('hidden');
                }
            });
            
            // Reset username validation when input changes
            document.getElementById('username').addEventListener('input', function() {
                validationState.usernameChecked = false;
                validationState.usernameAvailable = false;
                document.getElementById('usernameValidation').classList.add('hidden');
            });
            
            // Reset email validation when input changes
            document.getElementById('email').addEventListener('input', function() {
                validationState.emailCodeSent = false;
                validationState.emailVerified = false;
                document.getElementById('emailCodeSection').classList.add('hidden');
                document.getElementById('emailValidation').classList.add('hidden');
                document.getElementById('emailVerifyBtn').textContent = '인증발송';
            });
            
            // File upload handling
            document.getElementById('businessCertificate').addEventListener('change', handleFileUpload);
        });
    </script>
</body>
</html>